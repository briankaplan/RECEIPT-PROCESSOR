<!DOCTYPE html>
<html lang="en" data-theme="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TallyUps - Test Page</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='enhanced_style.css') }}">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
</head>
<body>
    <div class="app">
        <header class="header">
            <div class="header-content">
                <div class="app-logo">
                    <div class="logo-icon">
                        <i class="fas fa-chart-line"></i>
                    </div>
                    <div class="logo-text">
                        <h1>TallyUps</h1>
                        <p>TEST PAGE</p>
                    </div>
                </div>
            </div>
        </header>

        <main class="dashboard">
            <div style="padding: 2rem; max-width: 800px; margin: 0 auto;">
                <h2>üß™ TallyUps Function Test</h2>
                
                <div style="margin: 2rem 0;">
                    <h3>Core Functions</h3>
                    <button onclick="testCoreFunctions()" style="margin: 0.5rem; padding: 0.5rem 1rem; background: var(--primary-green); color: black; border: none; border-radius: 4px; cursor: pointer;">
                        Test Core Functions
                    </button>
                </div>

                <div style="margin: 2rem 0;">
                    <h3>Quick Actions</h3>
                    <button onclick="TallyUps.camera.toggle()" style="margin: 0.5rem; padding: 0.5rem 1rem; background: var(--accent-blue); color: white; border: none; border-radius: 4px; cursor: pointer;">
                        Camera Toggle
                    </button>
                    <button onclick="toggleSettings()" style="margin: 0.5rem; padding: 0.5rem 1rem; background: var(--accent-purple); color: white; border: none; border-radius: 4px; cursor: pointer;">
                        Toggle Settings
                    </button>
                    <button onclick="toggleTheme()" style="margin: 0.5rem; padding: 0.5rem 1rem; background: var(--accent-yellow); color: black; border: none; border-radius: 4px; cursor: pointer;">
                        Toggle Theme
                    </button>
                </div>

                <div style="margin: 2rem 0;">
                    <h3>Transaction Functions</h3>
                    <button onclick="syncBankTransactions()" style="margin: 0.5rem; padding: 0.5rem 1rem; background: var(--accent-blue); color: white; border: none; border-radius: 4px; cursor: pointer;">
                        Sync Banks
                    </button>
                    <button onclick="scanEmailReceipts()" style="margin: 0.5rem; padding: 0.5rem 1rem; background: var(--accent-purple); color: white; border: none; border-radius: 4px; cursor: pointer;">
                        Scan Emails
                    </button>
                    <button onclick="exportToSheets()" style="margin: 0.5rem; padding: 0.5rem 1rem; background: var(--accent-green); color: white; border: none; border-radius: 4px; cursor: pointer;">
                        Export to Sheets
                    </button>
                </div>

                <div style="margin: 2rem 0;">
                    <h3>API Test</h3>
                    <button onclick="testAPI()" style="margin: 0.5rem; padding: 0.5rem 1rem; background: var(--primary-green); color: black; border: none; border-radius: 4px; cursor: pointer;">
                        Test API
                    </button>
                    <div id="api-result" style="margin-top: 1rem; padding: 1rem; background: var(--bg-card); border-radius: 4px; font-family: monospace; font-size: 0.9rem;"></div>
                </div>

                <div style="margin: 2rem 0;">
                    <h3>Console Log</h3>
                    <div id="console-log" style="height: 200px; overflow-y: auto; padding: 1rem; background: var(--bg-card); border-radius: 4px; font-family: monospace; font-size: 0.8rem; border: 1px solid var(--border-light);"></div>
                </div>
            </div>
        </main>
    </div>

    <script src="{{ url_for('static', filename='script.js') }}"></script>
    <script>
        // Override console.log to capture logs
        const originalLog = console.log;
        const originalError = console.error;
        const logContainer = document.getElementById('console-log');
        
        function addToLog(message, type = 'log') {
            const timestamp = new Date().toLocaleTimeString();
            const logEntry = document.createElement('div');
            logEntry.style.color = type === 'error' ? '#ff6b6b' : '#00ff88';
            logEntry.style.marginBottom = '0.25rem';
            logEntry.textContent = `[${timestamp}] ${message}`;
            logContainer.appendChild(logEntry);
            logContainer.scrollTop = logContainer.scrollHeight;
        }
        
        console.log = function(...args) {
            originalLog.apply(console, args);
            addToLog(args.join(' '));
        };
        
        console.error = function(...args) {
            originalError.apply(console, args);
            addToLog(args.join(' '), 'error');
        };

        function testCoreFunctions() {
            console.log('üß™ Testing core functions...');
            
            // Test if TallyUps object exists
            if (window.TallyUps) {
                console.log('‚úÖ TallyUps object exists');
            } else {
                console.error('‚ùå TallyUps object missing');
            }
            
            // Test if functions exist
            const functions = [
                'toggleSettings', 'toggleTheme', 'syncBankTransactions', 
                'scanEmailReceipts', 'exportToSheets', 'processAI', 
                'calendarAnalysis', 'closeModal', 'saveTransactionEdit',
                'saveTransactionSplit', 'showToast', 'showError'
            ];
            
            functions.forEach(func => {
                if (typeof window[func] === 'function') {
                    console.log(`‚úÖ ${func} function exists`);
                } else {
                    console.error(`‚ùå ${func} function missing`);
                }
            });
        }

        async function testAPI() {
            console.log('üß™ Testing API...');
            const resultDiv = document.getElementById('api-result');
            
            try {
                const response = await fetch('/transactions?page=1&page_size=5');
                const data = await response.json();
                
                if (data.success) {
                    resultDiv.innerHTML = `
                        <div style="color: #00ff88;">‚úÖ API Working</div>
                        <div>Total: ${data.total}</div>
                        <div>Page: ${data.page}</div>
                        <div>Page Size: ${data.page_size}</div>
                        <div>Total Pages: ${data.total_pages}</div>
                        <div>Transactions: ${data.transactions.length}</div>
                    `;
                    console.log('‚úÖ API test successful:', data);
                } else {
                    resultDiv.innerHTML = `<div style="color: #ff6b6b;">‚ùå API Error: ${data.error}</div>`;
                    console.error('‚ùå API test failed:', data);
                }
            } catch (error) {
                resultDiv.innerHTML = `<div style="color: #ff6b6b;">‚ùå API Error: ${error.message}</div>`;
                console.error('‚ùå API test error:', error);
            }
        }

        // Initialize test page
        document.addEventListener('DOMContentLoaded', function() {
            console.log('üß™ Test page loaded');
            console.log('üåê Current theme:', document.documentElement.getAttribute('data-theme'));
            console.log('üì± Viewport:', window.innerWidth + 'x' + window.innerHeight);
        });
    </script>
</body>
</html> 